# Custom rules to enhance security

# Block SQL Injection attempts
SecRule ARGS "@contains SELECT" \
    "id:1000001,\
    phase:2,\
    deny,\
    status:403,\
    log,\
    msg:'SQL Injection Attempt Detected',\
    logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\
    t:lowercase,\
    redirect:/errors/403_modsecurity.html"

# Block attempts to access common sensitive files
SecRule REQUEST_URI "@rx (?:/etc/passwd|/etc/shadow|\.htaccess|\.git/|\.env)" \
    "id:1000002,\
    phase:1,\
    deny,\
    status:403,\
    log,\
    msg:'Attempt to access sensitive file',\
    logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\
    redirect:/errors/403_modsecurity.html"

# Block common XSS patterns
SecRule ARGS "@contains <script>" \
    "id:1000003,\
    phase:2,\
    deny,\
    status:403,\
    log,\
    msg:'XSS Attack Attempt Detected',\
    logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',\
    t:lowercase,\
    redirect:/errors/403_modsecurity.html" 